# Кофнигурация режима работы GC
GC поддерживает два основных режима работы (GC mods), которрые определяют то как он взаиможействует с приложением:

## Workstation GC
Оптимизирован для клиентских прилрожений с низкой задержкой. Этот режим предполагает, что приложение работает на одном устройстве и приоритет отдается отзывчивости пользовательского интерфейса.

### Особенности:
- Работает в одном процессе с приложением
- Используте меньше памяти но не эффективен для высоко нагруженных приложений

### Подрежимы
- **Concurrent:** GC работает параллельно с приложением (по умолчанию в .NET Framework)
- **Non-concurrent:** Работает в одном потоке с приложением, что может вызвать паузы в UI, но быстрее освобождает память

{% note info "Когда использовать" %}

Для декстопных приложений в которых важна низкая задержка для UI.

{% endnote %}

## Server GC
Оптимизирован для серверных приложений с высокой нагрузкой. Использует все процессоры, так что лучше работает на многопроцессорных системах.

### Особенности
- Создает отдельную кучу и поток GC для каждого логического процессора ОС
- Использует больше памяти но обечпесивает лучшую производительность при больших нагрузках

{% note warning %}

В .NET Core и .NET 5 использует фоновую уборку (Backgroung GC), котолрая минимизирует паузы путем:
- Уборка поколений 0 и 1 происходит параллельно с приложением
- Уборка поколения 2 происходит после остановки основног опотока (как обычно)

На однопроцессорных системах ServerGC будет работать как WorkstationGC

{% endnote %}

{% note info "Когда использовать" %}

Для серверных приложений, таких как API на ASP.NET Core, где важна высокая пропускная способность и масштабируемость.

{% endnote %}

## Как переключать режимы
Для этого есть `System.Runtime.GCSettings.IsServerGC`, `true` для включения **ServerGC**, `false` для включения **WorkstationGC**.
Также режим моджно настроить через конфиг приложения:
```json
{
    "runtimeOptions": {
        "configProperties": {
            "System.GC.Server": false, // Включение Workstation GC
            "System.GC.Concurrent": true // Включение concurrent GC
        }
    }
}
```
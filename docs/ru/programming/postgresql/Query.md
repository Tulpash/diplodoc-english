# Как выполняется запрос


## 1. Получение запроса
Клиент щлет запрос на сервер БД

## 2. Парсинг
- Разбирает запрос на лексемы
- Строит синтаксическое дерево
- Проверяет синтаксическую корректность запроса
- Если запрос содержит ошибки, то клиенту сразу возвращается ошибка

{% note info %}

Парсер проверяет только синтаксические ошибки, но не семантические

{% endnote %}

## 3. Анализ и Переписывание
- Проверяет семантику:
    - Права на доступ
    - Существуют ли данные таблицы, колонки и т.д.
    - Соответствие типов данных
    - Переписывает запрос: заменяет представления на запрос, `RULES`

{% note info %}

Для проверки анализатор использует метаданные из системных каталогов: `pg_class`, `pg_attribute`.

{% endnote %}

## 4. Планирование
Модуль отвечающий за планирование создает несколько планов исполнения запроса и оценивает их на основе:
- Статистики о данных (размер талицы, распределение значений, ...)
- Наличия индексов
- Оценочная стоимость операций

# 5. Исполнение
Модуль ответственный за исполнение запросов собственно выполняет запрос по плану одобренному на предудущем шаге, вначале изменения записываются в WAL, потом уже идет непосредственно работа с дисками, буферами и т.д.

# 6. Уровень доступа к данным
Это уже конкретно уровень физического доступа у данным на диске.